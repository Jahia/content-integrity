# <a name="summary"></a>Content Integrity - Release notes
* [How to use it](../README.md#summary)
* [Embedded tests](embedded-tests.md#summary)
* [How to extend it](how-to-extend.md#summary)
* [Groovy scripts](groovy-scripts.md#summary)
* [Release notes](#release-notes)
  * [Jahia 8](#jahia-8) ([latest](#latest))
  * [Jahia 7](#jahia-7) ([latest](#latest-v7))

## <a name="release-notes"></a>Release notes

### Jahia 8

| Version | Required Jahia version | Changes                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|---------|------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 3.0     | 8.0.2.0                | <a name="v3-0"></a><ul><li>First version for the Jahia 8.x family</li><li>Equivalent to `content-integrity 2.20`</li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| 3.1     | 8.0.2.0                | <a name="v3-1"></a><ul><li>AceSanityCheck<ul><li>Improved the detection of external ACE having a wrong path</li><li>[bugfix] Avoid false positives with external ACE defined for an ACE stored outside from a site and granting permissions on the current site</li><li>[bugfix] Avoid logging twice the external ACE defined for an ACE not of type GRANT</li></ul></li><li>VersionHistoryCheck<ul><li>Reduced the scan duration in the live workspace. Only the UGC nodes will be considered when scanning this workspace, the other nodes will be skipped since they can be checked while scanning the default workspace</li></ul></li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| 3.2     | 8.0.2.0                | <a name="v3-2"></a><ul><li>Implemented a new execution condition, based on some properties defined on the node</li><li>SiteLevelSystemGroupsCheck<ul><li>[bugfix] If the `privileged` group is missing, log it only once, instead of one time per scanned site</li></ul></li><li>WipSanityCheck<ul><li>[bugfix] Fixed the execution conditions</li></ul></li><li>PublicationSanityDefaultCheck<ul><li>When the scan is not run from the root of the JCR, and a different path in default & live is identified on the root node of the scan, consider the possibility that it is an inherited consequence from a parent node outside from the scope of the scan</li></ul></li><li>HomePageDeclarationCheck<ul><li>When no page is flagged as the home page, but a sub-node of the site is named `home`, generate a different error depending on if this node is a page or not</li></ul></li><li>LockSanityCheck<ul><li>Added the detection of the deletion locks remaining on a translation node after an undeletion</li></ul></li><li>Command `jcr:integrity-configureCheck`<ul><li>Added a completer on the parameter name option (`-p`)</li></ul></li></ul>                                                                                                                                                 |
| 3.3     | 8.0.2.0                | <a name="v3-3"></a><ul><li>Command `jcr:integrity-printTestResults`<ul><li>Added the possibility to upload the report in the JCR</li></ul></li><li>Command `jcr:integrity-check`<ul><li>[bugfix] Do not skip the disabled checks when they are explicitly specified in the list of checks to execute</li></ul></li><li>PublicationSanityDefaultCheck<ul><li>[bugfix] When the scan is not run from the root of the JCR, and a different path in default & live is identified on the root node of the scan, do not log an error on each sub-node</li></ul></li><li>PublicationSanityLiveCheck<ul><li>Implemented a comparison on the property values between the workspaces default and live, on the nodes without pending modifications</li></ul></li><li>Implemented a [groovy script](groovy-scripts.md#scanrefstositecontent) to detect the references from outside from a site</li><li>Improved the output of the errors list in the shell</li><li>Refactored the check ID to use a string instead of a number</li><li>Implemented a completer on the check ID</li></ul>                                                                                                                                                                                                                                  |
| 3.4     | 8.0.2.0                | <a name="v3-4"></a><ul><li>Implemented a UI (server settings)</li><li>Implemented a GraphQL API</li><li>[bugfix] Prevent concurrent executions</li><li>[bugfix] Catch any error thrown when scanning the children nodes, to let the scan continue properly</li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | 
| 3.5     | 8.0.2.0                | <a name="v3-5"></a><ul><li>UI<ul><li>Moved the UI under system-health</li><li>Display the description of the configurations</li><li>Display a link to download the report at the end of a scan</li><li>[bugfix] Do not crash when an invalid root path is specified</li><li>[bugfix] Fixed the label in the navigation</li></ul></li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| 3.6     | 8.0.2.0                | <a name="v3-6"></a><ul><li>UI<ul><li>[bugfix] Fixed the save of the configurations</li></ul></li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| 3.7     | 8.0.2.0                | <a name="v3-7"></a><ul><li>UI<ul><li>When refreshing the logs, scroll to the bottom</li><li>Added the possibility to exclude some paths from the scan</li></ul></li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| 3.8     | 8.0.2.0                | <a name="v3-8"></a><ul><li>AceSanityCheck<ul><li>[bugfix] Avoid false positives with external ACE defined for a path that ends with a slash</li></ul></li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| 3.9     | 8.0.2.0                | <a name="v3-9"></a><ul><li>[bugfix] Fixed the UI when not running Jahia under the ROOT context</li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| 3.10    | 8.0.2.0                | <a name="v3-10"></a><ul><li>Implemented a new check on the user accounts: `UserAccountSanityCheck`<ul><li>Detect the cased when the user is not granted the role `owner` on his own account</li></ul></li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| 3.11    | 8.0.2.0                | <a name="v3-11"></a><ul><li>Implemented a new check to detect child nodes not allowed by their parent node definition: `ChildNodeDefinitionsSanityCheck`</li><li>Framework<ul><li>Added the possibility to disable a check for the rest of the duration of the scan</li></ul></li><li>PropertyDefinitionsSanityCheck<ul><li>[bugfix] Fixed the detection of the `i18n` properties written on the main node (now reported as undeclared)</li><li>Performance improvement</li></ul></li><li>JCRLanguagePropertyCheck<ul><li>Embed in the error the value of the `jcr:language` property when detected as inconsistent with the node name</li></ul></li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| 3.12    | 8.0.2.0                | <a name="v3-12"></a><ul><li>Framework<ul><li>[bugfix] Fixed the automated disabling of a check which throws too many errors</li></ul></li><li>PropertyDefinitionsSanityCheck<ul><li>[bugfix] Fixed NPE</li></ul></li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| 3.13    | 8.0.2.0                | <a name="v3-13"></a><ul><li>Framework<ul><li>Write the execution summary and some other information related to the scan on the report file node in the JCR</li><li>Execution duration summary: log the number of scanned nodes</li><li>Execution duration summary: log the number of errors found</li><li>Improved the formatting of the generated CSV file to ease the parsing by Excel (*we miss you Greg :)* )</li></ul></li><li>BinaryPropertiesSanityCheck<ul><li>Reduced the duration of the check by default, using a light strategy. The former strategy can be enabled back by configuration</li></ul></li><li>PropertyDefinitionsSanityCheck<ul><li>[bugfix] Fixed the validation of the properties declared as `unstructured`, which were wrongly reported as undeclared</li></ul></li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| 3.14    | 8.0.2.0                | <a name="v3-14"></a><ul><li>Framework<ul><li>Execution duration summary: log the duration of the initial nodes count</li><li>Execution duration summary: improved the calculation of the duration of the scan of the tree</li><li>Execution duration summary: improved the formatting</li><li>Added the possibility to exclude the virtual nodes</li></ul></li><li>UI<ul><li>Added a configuration to exclude the virtual nodes</li><li>Added a link to the documentation of each check</li></ul></li><li>Command `jcr:integrity-configureCheck`<ul><li>Added a configuration to exclude the virtual nodes</li></ul></li><li>AceSanityCheck<ul><li>Detect the `ACE` which are not of type `GRANT` but are referenced by an `external ACE`</li></ul></li><li>UndeployedModulesReferencesCheck<ul><li>Improved the performances</li></ul></li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| 3.15    | 8.0.2.0                | <a name="v3-15"></a><ul><li>Implemented a new check on the properties defined by the mixin `jmix:nodenameInfo`: `NodeNameInfoSanityCheck`</li><li>PublicationSanityLiveCheck<ul><li>[bugfix] Avoid false positives related to the mixin `jmix:deletedChildren`</li></ul></li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| 3.16    | 8.0.2.0                | <a name="v3-16"></a><ul><li>Framework<ul><li>[bugfix] Fixed the execution of disabled checks when running a scan with a list of checks to execute</li></ul></li><li>UndeployedModulesReferencesCheck<ul><li>Removed the site name from the errors to generate the same text for the same missing module</li></ul></li><li>AceSanityCheck<ul><li>[bugfix] `ACE_NON_GRANT_WITH_EXTERNAL_ACE` : fixed the description of the error</li></ul></li><li>Script `scanRefsToSiteContent`<ul><li>Added the possibility to track the external references in the references keeper</li></ul></li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| 3.17    | 8.0.2.0                | <a name="v3-17"></a><ul><li>UI<ul><li>[bugfix] Do not generate a link to the documentation for the custom checks</li><li>[bugfix] When selecting no check, a scan was run using every active check</li><li>When receiving additional logs, keep the current position if not scrolled to the bottom</li><li>[bugfix] When scanning the 2 workspaces, do not start scanning the second workspace when stopping the process during the scan of the first one</li></ul></li><li>Framework<ul><li>Separate in the CSV reports the extra information which can be used for grouping purpose from those which are specific to the current error</li></ul></li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| 3.18    | 8.0.2.0                | <a name="v3-18"></a><ul><li>Framework<ul><li>Added a `Site` column in the generated CSV reports</li><li>Excluded paths are now tracked in the logs</li><li>Add the mixin `jmix:nolive` to the reports uploaded in the JCR, to avoid unwanted publications (this doesn't apply to the already uploaded reports)</li><li>Implemented the possibility to check if the conditions of an integrityCheck are reachable during a scan, and exclude those for which they are not</li><li>Do not start the scan if no integrity check can be run</li><li>[bugfix] Prevent scanning when starting a scan from a node in the subtree of an excluded path</li></ul></li><li>PublicationSanityLiveCheck<ul><li>When different mixins are found on a published node in the 2 workspaces, add the mixin names to error data</li><li>Excluded some properties from the comparison to avoid false positives</li></ul></li><li>AceSanityCheck<ul><li>[bugfix] Avoid false positives when processing an external ACE defined for a scope declared not by the role itself, but inherited from its parent role</li></ul></li></ul>                                                                                                                                                                                                 |
| 3.19    | 8.0.2.0                | <a name="v3-19"></a><ul><li>UI<ul><li>Added a panel to analyze the errors raised by the past scans</li><li>Increased the size of the logs area in the scan panel</li><li>Log the intermediate errors count in the UI logs as well</li></ul></li><li>Framework<ul><li>Increased the scan results cache duration to 5 weeks (time to idle)</li><li>Limited the size of the logs sent over GQL</li><li>[bugfix] Skip the nodes which do not have a correct path according to their node name and parent node path, to avoid `StackOverflowError` errors</li><li>[bugfix] Keep the declaration order of the check configurations, so that the order is the same in the UI when a check holds multiple configurations</li></ul></li><li>BinaryPropertiesSanityCheck<ul><li>Added the possibility to consider the valid binaries with a length of zero byte as errors</li><li>Fully read the binary and compare it to its size when using the `download-stream` strategy</li></ul></li><li>NodeNameInfoSanityCheck<ul><li>Improved the detection of the real errors</li><li>Excluded some false positives</li><li>The check is now active by default, since the error detection is finalized</li></ul></li><li>Implemented a new check to detect the hardcoded internal links: `StaticInternalLinksCheck`</li></ul> |
| 3.20    | 8.0.2.0                | <a name="v3-20"></a><ul><li>Framework</li><ul><li>Added the possibility to generate several report files</li><li>Added the generation of an Excel report, with a sheet containing the errors data, and a sheet with a predefined pivot table for errors analysis</li><li>Errors related to a module (under `/modules`) are now showing the module name in the "_site_" column of the reports</li><li>[bugfix] Avoid crashing when an error occurs while loading the next child node of a node (during the scan itself or during the calculation of the size of the tree)</li></ul><li>NodeNameInfoSanityCheck</li><ul><li>Disabled the check of the fullpath by default, with the possibility to enable it back by configuration</li></ul><li>PublicationSanityDefaultCheck</li><ul><li>Added the detection of the auto-published nodes which are missing from the `live` workspace</li></ul></ul>                                                                                                                                                                                                                                                                                                                                                                                                            |
| 3.21    | 8.0.2.0                | <a name="v3-21"></a><a name="latest"></a><ul><li>Implemented a new check to detect the invalid references: `ReferencesSanityCheck`</li><li>Framework<ul><li>[bugfix] Fixed the calculation of the count ranges (used to aggregate errors returning a similar number, such as the number of versions)</li><li>[bugfix] Excel report: avoid crashing when the scan has identified more than 32767 errors</li><li>[bugfix] Improved the reset of the JCR sessions between 2 executions</li></ul></li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |

### Jahia 7

| Version | Required Jahia version | Changes                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|---------|------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 2.0     | 7.2.0.0                | <ul><li>Initial version</li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| 2.1     | 7.2.0.0                | <ul><li>Implemented BinaryPropertiesSanityCheck</li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| 2.2     | 7.2.0.0                | <ul><li>Implemented TemplatesIndexationCheck</li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| 2.3     | 7.2.0.0                | <ul><li>Implemented a sanity check for the "work in progress" related properties</li><li>Implemented the possibility to define a minimum Jahia version for an integrity check</li><li>[bugfix] Fixed the execution conditions on MarkedForDeletionCheck</li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| 2.4     | 7.2.0.0                | <ul><li>Implemented a sanity check on the system groups</li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| 2.5     | 7.2.0.0                | <ul><li>Implemented an option to exclude a subtree from the scan</li><li>Implemented an "estimated time of arrival"</li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| 2.6     | 7.2.0.0                | <ul><li>[bugfix] Move operation that can't be published: do not test on the translation nodes</li><li>Added an optional header to the CSV dump (generated by default)</li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| 2.7     | 7.3.0.0                | <ul><li>Added the possibility to configure some integrity checks</li><li>Implemented a sanity check to detect nodes with too many versions</li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| 2.8     | 7.3.0.0                | <ul><li>Implemented a sanity check on the ACE nodes, in order to detect ACE related to deleted users or groups</li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| 2.9     | 7.3.0.0                | <ul><li>Implemented a factory method to create an empty errors list</li><li>[bugfix] Fixed the calculation of the number of nodes to scan when scanning the whole repository</li><li>[bugfix] Fixed the time calculation in case of error</li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| 2.10    | 7.3.0.0                | <ul><li>Improved the sanity check on the ACE nodes</li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| 2.11    | 7.3.0.0                | <ul><li>[bugfix] Fixed the comparison of the roles between an ACE and a related externalACE</li><li>UndeployedModulesReferencesCheck<ul><li>Return one error per missing module</li></ul></li><li>[bugfix] Do not report errors for nodes having a different path between default and live when the node is not the root of the move operation</li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| 2.12    | 7.3.0.0                | <ul><li>AceSanityCheck<ul><li>Log external ACE with a property j:sourceAce having no value</li><li>[bugfix] Fixed the detection of ACE which are not in the same site as their related external ACE</li></ul></li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| 2.13    | 7.3.0.0                | <ul><li>AceSanityCheck<ul><li>[bugfix] Fixed the detection of ACE which are not in the same site as their related external ACE</li><li>[bugfix] Fixed the calculation of the false positives when dealing with a broken reference to a source ACE in live</li></ul></li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| 2.14    | 7.3.0.0                | <ul><li>AceSanityCheck<ul><li>Detect ACE / external ACE without ACE type</li><li>Detect external ACE with a type different from 'GRANT'</li><li>Detect external ACE with a reference to a source ACE having a type different from 'GRANT'</li><li>Detect the ACE having a type different from 'GRANT' and being referenced by an external ACE</li><li>[bugfix] Do not check the consistency of the external ACE for the ACE having a type different from 'GRANT'</li></ul></li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| 2.15    | 7.3.0.0                | <ul><li>AceSanityCheck<ul><li>Detect the external ACE defined for a role which does not exist</li><li>Detect the external ACE defined for external permissions which are not declared by the role</li></ul></li><li>VersionHistoryCheck<ul><li>[bugfix] When the version history can't be loaded for a node, log the full stacktrace only when the log level is set to debug</li><li>[bugfix] Skip the external nodes with a custom decorator</li></ul></li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| 2.16    | 7.3.0.0                | <ul><li>Implemented a check on the property definitions<ul><li>Detection of the missing mandatory properties</li><li>Detection of the properties having their value not matching the declared constraint</li><li>Detection of the properties having their value not matching the declared type</li><li>Detection of the properties having a single-valued value and declared as multi-valued</li><li>Detection of the properties having a multi-valued value and declared as single-valued</li><li>Detection of the non declared properties</li></ul></li><li>Implemented a command to print out some extended information about an error</li><li>Sum up of the check durations at the end of the scan: sort the checks by duration</li></ul>                                                                                                                                                                                                                                                                                                                                                                                              |
| 2.17    | 7.3.0.0                | <ul><li>Refactored the test results ID to embed the workspace name</li><li>Log the intermediate counts while counting the nodes to be scanned</li><li>Unified the output of the errors</li><li>[bugfix] Fixed the calculation of the number of nodes to scan when there's an error while iterating the JCR</li><li>PropertyDefinitionsSanityCheck<ul><li>[bugfix] Fixed the calculation of the fact that the external permission path is relative to the current site</li><li>[bugfix] Fixed the creation of errors when an ACE and its related currentSite external ACE are in different sites</li><li>[bugfix] When calculating the effective type of the values of a multi-valued property, return `weakreference` instead of `undefined` when the values are a mix of `weakreference` and `reference`</li></ul></li><li>PublicationSanityLiveCheck<ul><li>[bugfix] Fixed the execution condition to catch every node having the property `j:originWS`</li></ul></li></ul>                                                                                                                                                              |
| 2.18    | 7.3.0.0                | <ul><li>PropertyDefinitionsSanityCheck<ul><li>[bugfix] Consider Reference and Weakreference as the same type when comparing the value type with the property type</li></ul></li><li>AceSanityCheck<ul><li>Added some more info to explain & ease troubleshooting the "invalid principal" errors</li></ul></li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| 2.19    | 7.3.0.0                | <ul><li>Implemented a check to detect nodes based on a missing type</li><li>Reduce the memory footprint of the scan</li><li>[bugfix] Fixed NPE when the error has no extra infos</li><li>[bugfix] Avoid NPE on null errors</li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| 2.20    | 7.3.0.0                | <ul><li>Command `jcr:integrity-check`<ul><li>Added the possibility to specify the checks to execute</li><li>Added the possibility to specify some checks to skip</li><li>Added the possibility to interrupt a scan before its end</li><li>[bugfix] Calculation of the number of nodes to scan: do not crash on non JCR exceptions</li></ul></li><li>WipSanityCheck<ul><li>Detect nodes with an invalid value in j:workInProgressStatus</li><li>[bugfix] Fixed invalid error messages</li></ul></li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| 2.21    | 7.3.0.0                | <ul><li>AceSanityCheck<ul><li>Improved the detection of external ACE having a wrong path</li><li>[bugfix] Avoid false positives with external ACE defined for an ACE stored outside from a site and granting permissions on the current site</li><li>[bugfix] Avoid logging twice the external ACE defined for an ACE not of type GRANT</li></ul></li><li>VersionHistoryCheck<ul><li>Reduced the scan duration in the live workspace. Only the UGC nodes will be considered when scanning this workspace, the other nodes will be skipped since they can be checked while scanning the default workspace</li></ul></li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| 2.22    | 7.3.0.0                | <ul><li>Implemented a new execution condition, based on some properties defined on the node</li><li>SiteLevelSystemGroupsCheck<ul><li>[bugfix] If the `privileged` group is missing, log it only once, instead of one time per scanned site</li></ul></li><li>WipSanityCheck<ul><li>[bugfix] Fixed the execution conditions</li></ul></li><li>PublicationSanityDefaultCheck<ul><li>When the scan is not run from the root of the JCR, and a different path in default & live is identified on the root node of the scan, consider the possibility that it is an inherited consequence from a parent node outside from the scope of the scan</li></ul></li><li>HomePageDeclarationCheck<ul><li>When no page is flagged as the home page, but a sub-node of the site is named `home`, generate a different error depending on if this node is a page or not</li></ul></li><li>LockSanityCheck<ul><li>Added the detection of the deletion locks remaining on a translation node after an undeletion</li></ul></li><li>Command `jcr:integrity-configureCheck`<ul><li>Added a completer on the parameter name option (`-p`)</li></ul></li></ul> |  
| 2.23    | 7.3.0.0                | <ul><li>Command `jcr:integrity-printTestResults`<ul><li>Added the possibility to upload the report in the JCR</li></ul></li><li>Command `jcr:integrity-check`<ul><li>[bugfix] Do not skip the disabled checks when they are explicitly specified in the list of checks to execute</li></ul></li><li>PublicationSanityDefaultCheck<ul><li>[bugfix] When the scan is not run from the root of the JCR, and a different path in default & live is identified on the root node of the scan, do not log an error on each sub-node</li></ul></li><li>PublicationSanityLiveCheck<ul><li>Implemented a comparison on the property values between the workspaces default and live, on the nodes without pending modifications</li></ul></li><li>Implemented a [groovy script](groovy-scripts.md#scanrefstositecontent) to detect the references from outside from a site</li><li>Improved the output of the errors list in the shell</li><li>Refactored the check ID to use a string instead of a number</li><li>Implemented a completer on the check ID</li></ul>                                                                                  |    
| 2.24    | 7.3.1.0                | <ul><li>Implemented a UI (server settings)</li><li>Implemented a GraphQL API</li><li>[bugfix] Prevent concurrent executions</li><li>[bugfix] Catch any error thrown when scanning the children nodes, to let the scan continue properly</li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | 
| 2.25    | 7.3.1.0                | <ul><li>UI<ul><li>Moved the UI under system-health</li><li>Display the description of the configurations</li><li>Display a link to download the report at the end of a scan</li><li>[bugfix] Do not crash when an invalid root path is specified</li></ul></li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | 
| 2.26    | 7.3.1.0                | <ul><li>UI<ul><li>[bugfix] Fixed the save of the configurations</li></ul></li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | 
| 2.27    | 7.3.1.0                | <ul><li>UI<ul><li>When refreshing the logs, scroll to the bottom</li><li>Added the possibility to exclude some paths from the scan</li></ul></li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | 
| 2.28    | 7.3.1.0                | <ul><li>AceSanityCheck<ul><li>[bugfix] Avoid false positives with external ACE defined for a path that ends with a slash</li></ul></li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | 
| 2.29    | 7.3.1.0                | <ul><li>[bugfix] Fixed the UI when not running Jahia under the ROOT context</li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | 
| 2.30    | 7.3.1.0                | <ul><li>Implemented a new check on the user accounts: `UserAccountSanityCheck`<ul><li>Detect the cased when the user is not granted the role `owner` on his own account</li></ul></li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| 2.31    | 7.3.1.0                | <ul><li>Implemented a new check to detect child nodes not allowed by their parent node definition: `ChildNodeDefinitionsSanityCheck`</li><li>Framework<ul><li>Added the possibility to disable a check for the rest of the duration of the scan</li></ul></li><li>PropertyDefinitionsSanityCheck<ul><li>[bugfix] Fixed the detection of the `i18n` properties written on the main node (now reported as undeclared)</li><li>Performance improvement</li></ul></li><li>JCRLanguagePropertyCheck<ul><li>Embed in the error the value of the `jcr:language` property when detected as inconsistent with the node name</li></ul></li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| 2.32    | 7.3.1.0                | <ul><li>Framework<ul><li>[bugfix] Fixed the automated disabling of a check which throws too many errors</li></ul></li><li>PropertyDefinitionsSanityCheck<ul><li>[bugfix] Fixed NPE</li></ul></li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| 2.33    | 7.3.1.0                | <ul><li>Framework<ul><li>Write the execution summary and some other information related to the scan on the report file node in the JCR</li><li>Execution duration summary: log the number of scanned nodes</li><li>Execution duration summary: log the number of errors found</li><li>Improved the formatting of the generated CSV file to ease the parsing by Excel (*we miss you Greg :)* )</li></ul></li><li>BinaryPropertiesSanityCheck<ul><li>Reduced the duration of the check by default, using a light strategy. The former strategy can be enabled back by configuration</li></ul></li><li>PropertyDefinitionsSanityCheck<ul><li>[bugfix] Fixed the validation of the properties declared as `unstructured`, which were wrongly reported as undeclared</li></ul></li></ul>                                                                                                                                                                                                                                                                                                                                                        |
| 2.34    | 7.3.1.0                | <ul><li>Framework<ul><li>Execution duration summary: log the duration of the initial nodes count</li><li>Execution duration summary: improved the calculation of the duration of the scan of the tree</li><li>Execution duration summary: improved the formatting</li><li>Added the possibility to exclude the virtual nodes</li></ul></li><li>UI<ul><li>Added a configuration to exclude the virtual nodes</li><li>Added a link to the documentation of each check</li></ul></li><li>Command `jcr:integrity-configureCheck`<ul><li>Added a configuration to exclude the virtual nodes</li></ul></li><li>AceSanityCheck<ul><li>Detect the `ACE` which are not of type `GRANT` but are referenced by an `external ACE`</li></ul></li><li>UndeployedModulesReferencesCheck<ul><li>Improved the performances</li></ul></li></ul>                                                                                                                                                                                                                                                                                                              |
| 2.35    | 7.3.1.0                | <ul><li>Implemented a new check on the properties defined by the mixin `jmix:nodenameInfo`: `NodeNameInfoSanityCheck`</li><li>UI<ul><li>[bugfix] Fixed GraphQL errors making the UI unresponsive</li></ul></li><li>PublicationSanityLiveCheck<ul><li>[bugfix] Avoid false positives related to the mixin `jmix:deletedChildren`</li></ul></li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| 2.36    | 7.3.1.0                | <ul><li>Framework<ul><li>[bugfix] Fixed the execution of disabled checks when running a scan with a list of checks to execute</li></ul></li><li>UndeployedModulesReferencesCheck<ul><li>Removed the site name from the errors to generate the same text for the same missing module</li></ul></li><li>AceSanityCheck<ul><li>[bugfix] `ACE_NON_GRANT_WITH_EXTERNAL_ACE` : fixed the description of the error</li></ul></li><li>Script `scanRefsToSiteContent`<ul><li>Added the possibility to track the external references in the references keeper</li></ul></li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| 2.37    | 7.3.1.0                | <ul><li>UI<ul><li>[bugfix] Do not generate a link to the documentation for the custom checks</li><li>[bugfix] When selecting no check, a scan was run using every active check</li><li>When receiving additional logs, keep the current position if not scrolled to the bottom</li><li>[bugfix] When scanning the 2 workspaces, do not start scanning the second workspace when stopping the process during the scan of the first one</li></ul></li><li>Framework<ul><li>Separate in the CSV reports the extra information which can be used for grouping purpose from those which are specific to the current error</li></ul></li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| 2.38    | 7.3.1.0                | <ul><li>Framework<ul><li>Added a `Site` column in the generated CSV reports</li><li>Excluded paths are now tracked in the logs</li><li>Add the mixin `jmix:nolive` to the reports uploaded in the JCR, to avoid unwanted publications (this doesn't apply to the already uploaded reports)</li><li>Implemented the possibility to check if the conditions of an integrityCheck are reachable during a scan, and exclude those for which they are not</li><li>Do not start the scan if no integrity check can be run</li><li>[bugfix] Prevent scanning when starting a scan from a node in the subtree of an excluded path</li></ul></li><li>PublicationSanityLiveCheck<ul><li>When different mixins are found on a published node in the 2 workspaces, add the mixin names to error data</li></ul></li><li>Excluded some properties from the comparison to avoid false positives</li><li>AceSanityCheck<ul><li>[bugfix] Avoid false positives when processing an external ACE defined for a scope declared not by the role itself, but inherited from its parent role</li></ul></li></ul>                                                  |
| 2.39    | 7.3.1.0                | <a name="v2-39"></a>Same as [3.19](#v3-19)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| 2.40    | 7.3.1.0                | <a name="v2-40"></a>Same as [3.20](#v3-20)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| 2.41    | 7.3.1.0                | <a name="v2-41"></a><a name="latest-v7"></a>Same as [3.21](#v3-21)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
